<!doctype html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <title>果粒网-要制定</title>
        <meta name="keywords" content="户外,徒步,骑行,人文,亲子,滑雪">
	    <meta name="google-site-verification" content="ZRIqJ5yEOtfzmyJCs5FaiyFFQe1RsDLysEiiTGERVAU">
        <link rel="stylesheet" href="../css/layout.css">
        <link rel="stylesheet" href="../css/customs.css">
        <style>
            .n_content_left ul a:nth-of-type(3) li {
                background-color: rgb(255,153,51);
            }
        </style>
    </head>
    <body>
	    <div id="header"></div>
	    <div id="custom_content">
	        <div class="dz_wrap">
	            <div class="left_w">
	                <div class="dz_form C_box">
	                    <form id="dzform">
	                        <h3>出行需求<span>(<span class="must_fill"> * </span>表示必填项)</span></h3>
	                        <div>
	                            <ul>
	                                <li>
	                                    <label for="">姓名：<span class="must_fill"> * </span></label>
	                                    <input type="text" placeholder="姓名" class="necessary_content text_input person_name" model-input="Chinese">
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">电话：<span class="must_fill"> * </span></label>
	                                    <input type="number" placeholder="手机号" class="necessary_content text_input person_telphone" model-input="number">
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">邮箱：</label>
	                                    <input type="email" placeholder="邮箱" model-input="email" class="text_input person_email">
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">最佳联系时间：</label>
	                                    <span><input type="radio" name="contact" value="尽快联系">尽快联系</span>
	                                    <span><input type="radio" name="contact" value="非工作时间">非工作时间</span>
	                                    <span><input type="radio" name="contact" value="9:00 - 12:00">9:00 - 12:00</span>
	                                    <span><input type="radio" name="contact" value="12:00 - 13:00">12:00 - 13:00</span>
	                                    <span><input type="radio" name="contact" value="13:00 - 18:00">13:00 - 18:00</span>
	                                </li>
	                            </ul>
	                        </div>
	                        <h3>出行需求<span>(<span class="must_fill"> * </span>表示必填项)</span></h3>
	                        <div>
	                            <ul>
	                                <li>
	                                    <label for="">团队类型：</label>
	                                    <span><input type="radio" name="team_type" value="企业">企业</span>
	                                    <span><input type="radio" name="team_type" value="社团/学校">社团/学校</span>
	                                    <span><input type="radio" name="team_type" value="亲友">亲友</span>
	                                    <span><input type="radio" name="team_type" value="其他">其他</span>
	                                </li>
	                                <li>
	                                    <label for="">活动内容：</label>
	                                    <span><input class="active_content" type="checkbox" value="帆船/皮划艇">帆船/皮划艇</span>
	                                    <span><input class="active_content" type="checkbox" value="踏青赏花">踏青赏花</span>
	                                    <span><input class="active_content" type="checkbox" value="山地徒步">山地徒步</span>
	                                    <span><input class="active_content" type="checkbox" value="环湖骑行">环湖骑行</span>
	                                    <span><input class="active_content" type="checkbox" value="篝火露营">篝火露营</span>
	                                    <span  style="margin-left: 120px">&nbsp;<input class="active_content" type="checkbox" value="沙漠穿越">沙漠穿越</span>
	                                    <span>&nbsp;<input class="active_content" type="checkbox" value="海盗海豹">海盗海豹</span>
	                                    <span>&nbsp;<input class="active_content" type="checkbox" value="漂流溯溪">漂流溯溪</span>
	                                    <span>&nbsp;<input class="active_content" type="checkbox" value="家庭亲子">家庭亲子</span>
	                                    <span>&nbsp;<input class="active_content" type="checkbox" value="红色党建">红色党建</span>
	                                    <span  style="margin-left: 120px">&nbsp;<input class="active_content" type="checkbox" value="止境禅修">止境禅修</span>
	                                </li>
	                                <li>
	                                    <label for="">团建主题：</label>
	                                    <span><input class="team_theme" type="checkbox" value="定向赛">定向赛</span>
	                                    <span><input class="team_theme" type="checkbox" value="基地拓展">基地拓展</span>
	                                    <span><input class="team_theme" type="checkbox" value="主题拓展">主题拓展</span>
	                                    <span><input class="team_theme" type="checkbox" value="沙盘课程">沙盘课程</span>
	                                </li>
	                                <li>
	                                    <label for="">出发城市：</label>
	                                    <input type="text"  model-input="Chinese" class="text_input citys"/>
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">意向地：</label>
	                                    <input type="text" model-input="Chinese" class="text_input purpose"/>
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">出发日期：<span class="must_fill"> * </span></label>
	                                    <input type="text" class="necessary_content text_input dates" model-input="number_all" placeholder="例如20170101"/>
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">出行天数：<span class="must_fill"> * </span></label>
	                                    <input type="text" value="1" class="necessary_content text_input days"  model-input="number_all">   天（*默认为1天）
	                                    <span class="tips_input" style="left: 400px;"></span>
	                                </li>
	                                <li>
	                                    <label for="">出行人数：<span class="must_fill"> * </span></label>
	                                    <input type="text" class="necessary_content text_input person_num" model-input="number_all"/>
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">单人预算：</label>
	                                    <input type="text" class="text_input budget" model-input="number_all"/>
	                                    <span class="tips_input"></span>
	                                </li>
	                                <li>
	                                    <label for="">其他要求：</label>
	                                    <textarea class="other" id="" cols="60" rows="8"></textarea>
	                                </li>
	                                <li>
	                                    <label for="">验证码：</label>
	                                    <input class="yzm text_input" type="text" size="6">
	                                    <img class="yzmpic" src="" alt="验证码" onclick="createCode()">
	                                    <a style="text-decoration: underline" onclick="validate()">换一张</a>
	                                    <span class="tips_input" style="top: 30px;left: 300px;"></span>
	                                </li>
	                            </ul>
	                        </div>
	                        <input type="button" value="提交出行请求" class="submit_out">
	                    </form>
	                </div>
	            </div>
	            <div class="right_w">
	                <div class="process C_box">
	                    <h3>服务流程</h3>
	                    <div>
	                        <img src="../imgs/customs/dingzhi_steps.png" alt="">
	                        <dl>
	                            <dt>特别提醒：</dt>
	                            <dd>·遇到节假日，电话沟通和获得专属方案的时间顺延；</dd>
	                            <dd>·为了不打扰您的休息，我们电话沟通在9:00-22:00。</dd>
	                        </dl>
	                    </div>
	                </div>
	                <div class="consultant">
	                    <img src="../imgs/customs/greenboard_gw_01.png" alt="">
	                    <img src="../imgs/customs/greenboard_gw_02.png" alt="">
	                </div>
	            </div>
	        </div>
	    </div>
	    <div id="footer"></div>
    </body>
    <script src="../js/jquery.js"></script>
    <script>
        $(document).ready(function(){
            $("#header").load("header.html")
            $("#footer").load("footer.html");
        });
        var code ; //在全局定义验证码
        function createCode(){
            code = "";
            var codeLength = 4;//验证码的长度
            var checkCode = $(".yzmpic");
            var random = new Array(0,1,2,3,4,5,6,7,8,9,'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R',
                'S','T','U','V','W','X','Y','Z');//随机数
            for(var i = 0; i < codeLength; i++) {//循环操作
                var index = Math.floor(Math.random()*36);//取得随机数的索引（0~35）
                code += random[index];//根据索引取得随机数加到code上
            }
            checkCode.val(code);//把code值赋给验证码
        }
        createCode();
        //校验验证码
//        function validate(){
//            var inputCode = $(".yzm").text.toUpperCase(); //取得输入的验证码并转化为大写
//            if(inputCode.length <= 0) { //若输入的验证码长度为0
//                alert("请输入验证码！"); //则弹出请输入验证码
//            }else if(inputCode != code ) { //若输入的验证码与产生的验证码不一致时
//                alert("验证码输入错误！@_@"); //则弹出验证码输入错误
//                createCode();//刷新验证码
//                $(".yzm").val = "";//清空文本框
//            }else { //输入正确时
//                alert("合格！^-^");
//            }
//        }
        //判断用户输入的数据是否复合要求
		$(".text_input").blur(function(){
			var index = $(".text_input").index($(this));
			if($(this).hasClass("necessary_content")){ //必填项目
				if($(this).val() !==""){
					$(".tips_input").eq(index).text("");
					var val = $(this).val();
					var type = $(this).attr("model-input");
					decideFn(type,val,index);
				}else{
					$(".tips_input").eq(index).text("不能为空！");;
				}
			}else{ //不是必填项目 判断他的类型是否正确 
				if($(this).val() !=""){
					var val = $(this).val();
					var type = $(this).attr("model-input");
					decideFn(type,val,index);
				}
			}
		});
		//判断函数
		function decideFn(type,val,index){
			if(type == "Chinese"){
				//判断是否是汉字字符正则
				var reg = /[\u4E00-\u9FA5\uF900-\uFA2D]/;
				//判断是否是英文
				var reg1 = /^[a-zA-Z]+$/;
				if((decideChar(val,reg)||decideChar(val,reg1))&&(isNaN(val))){ //纯英文或者纯汉字或者都可以  不能是数字
					$(".tips_input").eq(index).text("");
				}else{
					$(".tips_input").eq(index).text("请输入英文或者中午名！");
				}
			}else if(type == "email"){
				//判断是否是邮箱的正则
				reg = /^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/;
				if(!decideChar(val,reg)){
					$(".tips_input").eq(index).text("请输入正确的邮箱地址！");
				}else{
					$(".tips_input").eq(index).text("");
				}
			}else if(type == "number"){
				var number1 = parseInt(val);
				//判断是否是手机号码的正则
				reg = /^1(3|4|5|7|8)\d{9}$/;
				if(!decideChar(number1,reg)){
					$(".tips_input").eq(index).text("请输入正确的手机号码！");
				}else{
					$(".tips_input").eq(index).text("");
				}
			}else if(type == "number_all"){
				var number1 = parseInt(val);
				reg = /^[0-9]+.?[0-9]*$/;
				if(!decideChar(val,reg)){
					$(".tips_input").eq(index).text("请输入的正确的日期！");
				}else{
					$(".tips_input").eq(index).text("");
				}
			}
		}
		//判断字符正则表达式
		function decideChar(str,reg){   
		   return reg.test(str);//结果
		}
		//表单数据不为空
        function testForm(){
	        $(".submit_out").on("click",function(){
	        		var arr_active = [];
	        		var arr_team = [];
	        		for(var i = 0;i<$(".active_content:checked").length;i++){
	        			arr_active.push($(".active_content:checked").eq(i).val());
	        		}
	        		for(var i = 0;i<$(".team_theme:checked").length;i++){
	        			arr_team.push($(".team_theme:checked").eq(i).val());
	        		}
//				$('input:radio:first').attr('checked', 'true');
	        		var inputs = $(".necessary_content");
	        		var empty = 0;  //保存为空的个数
				for(let i = 0 ;i < inputs.length; i++){
					$(".tips_input").eq(i).text("");
					if(inputs.eq(i).val() == ""){
						empty ++;
						$(".tips_input").eq(i).text("不能为空！");
					}
				}
				if(empty>0){
					return false;
				}else{
					$.ajax({
						type:"get",
						url:"customs_data_handle.php",
						async:true,
						data:{
							person_name:$('.person_name').val(),
							person_telphone:$('.person_telphone').val(),
							person_email:$('.person_email').val(),
							contact:$("input[name='contact']:checked").val(),
							team_type:$('input[name="team_type"]:checked').val(),
							active_content:arr_active,
							team_theme:arr_team,
							citys:$(".citys").val(),
							purpose:$('.purpose').val(),
							other:$('.other').val(),
							budget:$('.budget').val(),
							person_num:$('.person_num').val(),
							days:$('.days').val(),
							dates:$('.dates').val(),
						},success:function(str){
							var obj = $.parseJSON(str);
							if(obj.err==0){
								alert("恭喜您制定成功，客服会尽快联系您！")
							}
						}
					});
				}
	        });
     	 }
        testForm();
    </script>
</html>